<div class="card grid grid-flow-row-dense sm:grid-cols-1 md:grid-cols-1 gap-4">
    <div class="flex items-center gap-2">
        <i class="pi pi-list text-2xl"></i>
        <span class="text-xl font-semibold">Logs Notificaciones</span>
    </div>

    <p-table #dt1 rowExpandMode="single" styleClass="p-datatable-striped p-datatable-gridlines"
        (onRowExpand)="getOtps($event)"
        currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} registros" [paginator]="true"
        [showCurrentPageReport]="true" dataKey="operationId" [rows]="rows" [value]="datosNotificaciones"
        [totalRecords]="datosNotificaciones.length" [rowsPerPageOptions]="rowsPerPageOptions"
        [loading]="loadingNotificaciones">
        <ng-template pTemplate="header">
            <tr>
                <th scope="col"></th>
                <th scope="col">OPERATION_ID</th>
                <th scope="col">REGISTRO_CARTERA_DIGITAL_ID</th>
                <th scope="col">OPERATION</th>
                <th scope="col">DIGITAL_CARD_ID</th>
                <th scope="col">STATUS</th>
                <th scope="col">CORRELATION_ID</th>
                <th scope="col">FECHA_CREACION</th>
                <th scope="col">FECHA_ACTUALIZACION</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-expanded="expanded">
            <tr id="tableWithIcon">
                <td style="text-align: center;">
                    <a href="#" [pRowToggler]="rowData">
                        <em [ngClass]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></em>
                    </a>
                </td>
                <td>{{rowData.operationId}}</td>
                <td>{{rowData.registroCarteraDigitalId}}</td>
                <td>{{rowData.operation}}</td>
                <td>{{rowData.digitalCardId}}</td>
                <td>{{rowData.status}}</td>
                <td>{{rowData.correlationId}}</td>
                <td>{{rowData.fechaCreacion | date:'dd/MM/yyyy HH:mm:ss'}}</td>
                <td>{{rowData.fechaActualizacion | date:'dd/MM/yyyy HH:mm:ss'}}</td>
            </tr>
        </ng-template>
        <ng-template #expandedrow let-rowData>
            <tr>
                <td colspan="10" style="padding-left: 40px !important;">

                    <h5>OTPs</h5>
                    <p-table [paginator]="false" [value]="datosOtps" [totalRecords]="datosOtps.length"
                        [loading]="loadingOtps">
                        <ng-template pTemplate="header">
            <tr>
                <th scope="col">ID</th>
                <th scope="col">CORRELATION_ID</th>
                <th scope="col">CONSUMER_ID</th>
                <th scope="col">OTP</th>
                <th scope="col">DIGITAL_CARD_REQUESTOR_ID</th>
                <th scope="col">DIGITAL_CARD_REQUESTOR_WALLET_ID</th>
                <th scope="col">DIGITAL_CARD_REQUESTOR_NAME</th>
                <th scope="col">DIGITAL_CARD_REQUESTOR_TSPID</th>
                <th scope="col">DELIVERY_CHANNEL</th>
                <th scope="col">DATA_CHANNEL</th>
                <th scope="col">CREATION_DATE</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-row>
            <tr id="tableWithoutIcon">
                <td>{{row.id}}</td>
                <td>{{row.correlationId}}</td>
                <td>{{row.consumerId}}</td>
                <td>{{row.otp}}</td>
                <td>{{row.digitalCardRequestorId}}</td>
                <td>{{row.digitalCardRequestorWalletId}}</td>
                <td>{{row.digitalCardRequestorName}}</td>
                <td>{{row.digitalCardRequestorTspid}}</td>
                <td>{{row.deliveryChannel}}</td>
                <td>{{row.dataChannel}}</td>
                <td>{{row.creationDate}}</td>
            </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="11" style="text-align:left">Sin registros encontrados</td>
            </tr>
        </ng-template>
    </p-table>
    </td>
    </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
        <tr>
            <td colspan="9" style="text-align:left">Sin registros encontrados</td>
        </tr>
    </ng-template>
    </p-table>

    <div class="flex items-end justify-end gap-2 footer-modal">
        <p-button label="Cerrar" severity="secondary" (click)="cerrarModal()" (keydown.enter)="cerrarModal()"
            (keydown)="cerrarModal()"></p-button>
    </div>
</div>